<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h2>Course Enrollment Requests</h2>
    <table border="1">
        <thead>
            <tr>
                <th>Student Name</th>
                <th>Email</th>
                <th>Course Code</th>
                <th>Course Title</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="request-table-body"></tbody>
    </table>

    <script>
        // ---------- AJAX for Approve/Reject ----------
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll(".btn-action").forEach(btn => {
                btn.addEventListener("click", function () {
                    const student_course_id = this.dataset.id;
                    const action = this.dataset.action;

                    fetch("faculty_request_action.php", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: `student_course_id=${student_course_id}&action=${action}`
                    })
                        .then(res => res.json())
                        .then(data => {
                            if (data.success) {
                                const row = document.getElementById(`row-${student_course_id}`);
                                row.querySelector(".status").textContent = data.status;
                                // Optionally hide buttons after action
                                row.querySelectorAll(".btn-action").forEach(b => b.style.display = "none");
                            } else {
                                alert("Error: " + (data.error || "Unknown error"));
                            }
                        })
                        .catch(err => alert("Request failed: " + err));
                });
            });
        });
    </script>

</body>

</html>